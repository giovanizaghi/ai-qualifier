# AI Qualifier Security Configuration
# This file contains security settings and configurations for production deployment

# ========================================
# Rate Limiting Configuration
# ========================================

# Rate limiting for API endpoints (requests per minute)
API_RATE_LIMIT=100
API_BURST_LIMIT=20

# Rate limiting for authentication endpoints
AUTH_RATE_LIMIT=10
AUTH_BURST_LIMIT=5

# Rate limiting for file uploads
UPLOAD_RATE_LIMIT=5
UPLOAD_BURST_LIMIT=2

# Rate limiting for search endpoints
SEARCH_RATE_LIMIT=30
SEARCH_BURST_LIMIT=10

# ========================================
# Security Headers Configuration
# ========================================

# Content Security Policy
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net"
CSP_STYLE_SRC="'self' 'unsafe-inline' https://fonts.googleapis.com"
CSP_IMG_SRC="'self' data: https:"
CSP_FONT_SRC="'self' https://fonts.gstatic.com"
CSP_CONNECT_SRC="'self' https://api.github.com"

# HTTP Strict Transport Security (HSTS)
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# X-Frame-Options
X_FRAME_OPTIONS="DENY"

# X-Content-Type-Options
X_CONTENT_TYPE_OPTIONS="nosniff"

# Referrer Policy
REFERRER_POLICY="strict-origin-when-cross-origin"

# ========================================
# Authentication Security
# ========================================

# JWT token expiration (in seconds)
JWT_ACCESS_TOKEN_EXPIRY=3600  # 1 hour
JWT_REFRESH_TOKEN_EXPIRY=604800  # 7 days

# Password security requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true
PASSWORD_MAX_LOGIN_ATTEMPTS=5
PASSWORD_LOCKOUT_DURATION=1800  # 30 minutes

# Session security
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE="strict"
SESSION_MAX_AGE=86400  # 24 hours

# Two-factor authentication
ENABLE_2FA=true
TOTP_ISSUER="AI Qualifier"
TOTP_WINDOW=1

# ========================================
# Database Security
# ========================================

# Database connection security
DB_SSL_MODE="require"
DB_SSL_CERT_PATH="/etc/ssl/certs/postgresql.crt"
DB_SSL_KEY_PATH="/etc/ssl/private/postgresql.key"
DB_SSL_CA_PATH="/etc/ssl/certs/ca-certificates.crt"

# Connection pooling security
DB_MAX_CONNECTIONS=100
DB_CONNECTION_TIMEOUT=30
DB_IDLE_TIMEOUT=600

# Database encryption
DB_ENABLE_ENCRYPTION=true
DB_ENCRYPTION_KEY="$DATABASE_ENCRYPTION_KEY"

# ========================================
# File Upload Security
# ========================================

# Allowed file types
ALLOWED_FILE_TYPES="jpg,jpeg,png,gif,pdf,doc,docx,txt"
MAX_FILE_SIZE=10485760  # 10MB
MAX_FILES_PER_UPLOAD=5

# File storage security
FILE_STORAGE_ENCRYPTION=true
FILE_VIRUS_SCANNING=true
FILE_CONTENT_VALIDATION=true

# ========================================
# API Security
# ========================================

# CORS configuration
CORS_ORIGIN="https://yourdomain.com"
CORS_METHODS="GET,POST,PUT,DELETE,OPTIONS"
CORS_ALLOWED_HEADERS="Content-Type,Authorization,X-Requested-With"
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# API versioning
API_VERSION="v1"
API_DEPRECATION_NOTICE=true

# Request validation
REQUEST_SIZE_LIMIT="10mb"
REQUEST_TIMEOUT=30000  # 30 seconds
ENABLE_REQUEST_LOGGING=true

# ========================================
# Network Security
# ========================================

# Firewall configuration
ENABLE_FIREWALL=true
ALLOWED_PORTS="22,80,443,3000"
SSH_PORT=22
DISABLE_ROOT_LOGIN=true

# DDoS protection
ENABLE_DDOS_PROTECTION=true
DDOS_THRESHOLD=1000  # requests per minute
DDOS_BAN_DURATION=3600  # 1 hour

# IP whitelisting for admin endpoints
ADMIN_IP_WHITELIST="127.0.0.1,::1"

# ========================================
# SSL/TLS Configuration
# ========================================

# TLS version
TLS_MIN_VERSION="1.2"
TLS_MAX_VERSION="1.3"

# SSL certificate settings
SSL_CERT_PATH="/etc/ssl/certs/ai-qualifier.crt"
SSL_KEY_PATH="/etc/ssl/private/ai-qualifier.key"
SSL_CA_PATH="/etc/ssl/certs/ca-bundle.crt"

# OCSP stapling
ENABLE_OCSP_STAPLING=true

# Certificate transparency
ENABLE_CT_LOGS=true

# ========================================
# Monitoring and Alerting Security
# ========================================

# Security monitoring
ENABLE_SECURITY_MONITORING=true
SECURITY_LOG_LEVEL="INFO"
SECURITY_ALERT_THRESHOLD=5  # Failed attempts

# Intrusion detection
ENABLE_IDS=true
IDS_THRESHOLD=10  # Suspicious activities
IDS_NOTIFICATION_EMAIL="security@yourdomain.com"

# Log security
LOG_ENCRYPTION=true
LOG_INTEGRITY_CHECK=true
LOG_RETENTION_DAYS=90

# ========================================
# Compliance and Audit
# ========================================

# Audit logging
ENABLE_AUDIT_LOG=true
AUDIT_LOG_LEVEL="INFO"
AUDIT_LOG_RETENTION=365  # days

# Data protection
ENABLE_DATA_ANONYMIZATION=true
DATA_RETENTION_POLICY=2555  # days (7 years)
ENABLE_RIGHT_TO_BE_FORGOTTEN=true

# Compliance frameworks
GDPR_COMPLIANCE=true
SOX_COMPLIANCE=false
HIPAA_COMPLIANCE=false

# ========================================
# Backup Security
# ========================================

# Backup encryption
BACKUP_ENCRYPTION_ALGORITHM="AES-256-GCM"
BACKUP_KEY_ROTATION_DAYS=90

# Backup access control
BACKUP_ACCESS_CONTROL=true
BACKUP_MFA_REQUIRED=true

# ========================================
# Container Security
# ========================================

# Docker security
RUN_AS_NON_ROOT=true
USER_ID=1001
GROUP_ID=1001

# Container limits
MEMORY_LIMIT="2g"
CPU_LIMIT="1.0"
PID_LIMIT=1024

# Security scanning
ENABLE_VULNERABILITY_SCANNING=true
SCAN_FREQUENCY="daily"

# ========================================
# Environment Security
# ========================================

# Environment isolation
ENVIRONMENT="production"
DEBUG_MODE=false
VERBOSE_ERRORS=false

# Secret management
SECRETS_ENCRYPTION=true
SECRET_ROTATION_DAYS=30

# ========================================
# Third-party Security
# ========================================

# OAuth providers
GITHUB_CLIENT_ID="$GITHUB_CLIENT_ID"
GITHUB_CLIENT_SECRET="$GITHUB_CLIENT_SECRET"
GOOGLE_CLIENT_ID="$GOOGLE_CLIENT_ID"
GOOGLE_CLIENT_SECRET="$GOOGLE_CLIENT_SECRET"

# External API security
EXTERNAL_API_TIMEOUT=10000  # 10 seconds
EXTERNAL_API_RETRY_ATTEMPTS=3
EXTERNAL_API_RATE_LIMIT=100

# ========================================
# Incident Response
# ========================================

# Emergency contacts
SECURITY_TEAM_EMAIL="security@yourdomain.com"
INCIDENT_RESPONSE_WEBHOOK="$INCIDENT_WEBHOOK_URL"

# Automatic responses
ENABLE_AUTO_BLOCK=true
AUTO_BLOCK_THRESHOLD=10  # Failed attempts
AUTO_BLOCK_DURATION=3600  # 1 hour

# Forensics
ENABLE_FORENSIC_LOGGING=true
FORENSIC_LOG_RETENTION=365  # days